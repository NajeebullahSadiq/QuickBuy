{"ast":null,"code":"import _regeneratorRuntime from \"E:\\\\FullStack QuickBuy\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"E:\\\\FullStack QuickBuy\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"E:\\\\FullStack QuickBuy\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"E:\\\\FullStack QuickBuy\\\\frontend\\\\src\\\\Components\\\\MainContent\\\\OrderScreen\\\\OrderScreen.js\";\nimport Axios from \"axios\";\nimport { PayPalButton } from \"react-paypal-button-v2\";\nimport React from \"react\";\nimport { useState } from \"react\";\nimport { useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { Link } from \"react-router-dom\";\nimport { detailsOrder, payOrder } from \"../../../Actions/orderActions.js\";\nimport LoadingBox from \"../../LoadingBox.js\";\nimport MessageBox from \"../../MessageBox.js\";\nimport \"../PlaceOrderScreen/PlaceOrderScreen.css\";\nimport { ORDER_DELIVER_RESET, ORDER_PAY_RESET } from \"../../../Constants/orderConstants.js\";\nexport default function OrderScreen(props) {\n  var _this = this;\n\n  var orderId = props.match.params.id;\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      sdkReady = _useState2[0],\n      setSdkReady = _useState2[1];\n\n  var orderDetails = useSelector(function (state) {\n    return state.orderDetails;\n  });\n  var order = orderDetails.order,\n      loading = orderDetails.loading,\n      error = orderDetails.error;\n  var userSignin = useSelector(function (state) {\n    return state.userSignin;\n  });\n  var userInfo = userSignin.userInfo;\n  var orderPay = useSelector(function (state) {\n    return state.orderPay;\n  });\n  var loadingPay = orderPay.loading,\n      errorPay = orderPay.error,\n      successPay = orderPay.success;\n  var orderDeliver = useSelector(function (state) {\n    return state.orderDeliver;\n  });\n  var loadingDeliver = orderDeliver.loading,\n      errorDeliver = orderDeliver.error,\n      successDeliver = orderDeliver.success;\n  var dispatch = useDispatch();\n  useEffect(function () {\n    var addPayPalScript = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var _yield$Axios$get, data, script;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return Axios.get(\"/config/paypal\");\n\n              case 2:\n                _yield$Axios$get = _context.sent;\n                data = _yield$Axios$get.data;\n                script = document.createElement(\"script\");\n                script.type = \"text/javascript\";\n                script.src = \"https://www.paypal.com/sdk/js?client-id=\".concat(data);\n                script.async = true;\n\n                script.onload = function () {\n                  setSdkReady(true);\n                };\n\n                document.body.appendChild(script);\n\n              case 10:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function addPayPalScript() {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    if (!order || successPay || successDeliver || order && order._id !== orderId) {\n      dispatch({\n        type: ORDER_PAY_RESET\n      });\n      dispatch({\n        type: ORDER_DELIVER_RESET\n      });\n      dispatch(detailsOrder(orderId));\n    } else {\n      if (!order.isPaid) {\n        if (!window.paypal) {\n          addPayPalScript();\n        } else {\n          setSdkReady(true);\n        }\n      }\n    }\n  }, [dispatch, order, orderId, sdkReady, successPay, successDeliver]);\n\n  var successPaymentHandler = function successPaymentHandler(paymentResult) {\n    dispatch(payOrder(order, paymentResult));\n  };\n\n  var deliverHandler = function deliverHandler() {\n    dispatch(deliverOrder(order._id));\n  };\n\n  return loading ? /*#__PURE__*/React.createElement(LoadingBox, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 5\n    }\n  }) : error ? /*#__PURE__*/React.createElement(MessageBox, {\n    variant: \"danger\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 5\n    }\n  }, error) : /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }\n  }, \"Order \", order._id), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row top\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"ul\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"li\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"Shipping\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    className: \"Heads\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 17\n    }\n  }, \"Shipping\"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 19\n    }\n  }, \"Name:\"), \" \", order.shippingAddress.fullName, \" \", /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 75\n    }\n  }), /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 19\n    }\n  }, \"Address: \"), \" \", order.shippingAddress.address, \",\", order.shippingAddress.city, \",\", \" \", order.shippingAddress.postalCode, \",\", order.shippingAddress.country), order.isDelivered ? /*#__PURE__*/React.createElement(MessageBox, {\n    variant: \"success\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 19\n    }\n  }, \"Delivered at \", order.deliveredAt) : /*#__PURE__*/React.createElement(MessageBox, {\n    variant: \"danger\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 19\n    }\n  }, \"Not Delivered\"))), /*#__PURE__*/React.createElement(\"li\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"Payment_method\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    className: \"Heads\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 17\n    }\n  }, \"Payment\"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 19\n    }\n  }, \"Method:\"), \" \", order.paymentMethod), order.isPaid ? /*#__PURE__*/React.createElement(MessageBox, {\n    variant: \"success\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 19\n    }\n  }, \"Paid at \", order.paidAt) : /*#__PURE__*/React.createElement(MessageBox, {\n    variant: \"danger\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 19\n    }\n  }, \"Not Paid\"))), /*#__PURE__*/React.createElement(\"li\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card card-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 17\n    }\n  }, \"Order Items\"), /*#__PURE__*/React.createElement(\"ul\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 17\n    }\n  }, order.orderItems.map(function (item) {\n    return /*#__PURE__*/React.createElement(\"li\", {\n      key: item.product,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: item.image,\n      alt: item.name,\n      className: \"small\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 27\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"item\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(Link, {\n      to: \"/product/\".concat(item.product),\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 27\n      }\n    }, item.name)), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"item\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 25\n      }\n    }, item.qty, \" x \\u20B9\", item.price, \" = \\u20B9\", item.qty * item.price)));\n  })))))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"Summary_main\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"ul\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"li\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    className: \"order_summary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 17\n    }\n  }, \"Order Summary\")), /*#__PURE__*/React.createElement(\"li\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"Summary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 19\n    }\n  }, \"Items' Price\"), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 19\n    }\n  }, \"\\u20B9\", order.itemsPrice.toFixed(2)))), /*#__PURE__*/React.createElement(\"li\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"Summary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 19\n    }\n  }, \" Shipping\"), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 19\n    }\n  }, \"\\u20B9\", order.shippingPrice.toFixed(2)))), /*#__PURE__*/React.createElement(\"li\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"Summary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 19\n    }\n  }, \"Tax\"), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 19\n    }\n  }, \"\\u20B9\", order.taxPrice.toFixed(2)))), /*#__PURE__*/React.createElement(\"li\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    className: \"Summary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 21\n    }\n  }, \" Order Total\")), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 21\n    }\n  }, \"\\u20B9\", order.totalPrice.toFixed(2))))), !order.isPaid && /*#__PURE__*/React.createElement(\"li\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 17\n    }\n  }, !sdkReady ? /*#__PURE__*/React.createElement(LoadingBox, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 21\n    }\n  }) : /*#__PURE__*/React.createElement(React.Fragment, null, errorPay && /*#__PURE__*/React.createElement(MessageBox, {\n    variant: \"danger\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 25\n    }\n  }, errorPay), loadingPay && /*#__PURE__*/React.createElement(LoadingBox, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 38\n    }\n  }), /*#__PURE__*/React.createElement(PayPalButton, {\n    amount: order.totalPrice,\n    onSuccess: successPaymentHandler,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 23\n    }\n  }))), userInfo.isAdmin && order.isPaid && !order.isDelivered && /*#__PURE__*/React.createElement(\"li\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 17\n    }\n  }, loadingDeliver && /*#__PURE__*/React.createElement(LoadingBox, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 38\n    }\n  }), errorDeliver && /*#__PURE__*/React.createElement(MessageBox, {\n    variant: \"danger\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 21\n    }\n  }, errorDeliver), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    className: \"primary block\",\n    onClick: deliverHandler,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 19\n    }\n  }, \"Deliver Order\")))))));\n}","map":{"version":3,"sources":["E:/FullStack QuickBuy/frontend/src/Components/MainContent/OrderScreen/OrderScreen.js"],"names":["Axios","PayPalButton","React","useState","useEffect","useDispatch","useSelector","Link","detailsOrder","payOrder","LoadingBox","MessageBox","ORDER_DELIVER_RESET","ORDER_PAY_RESET","OrderScreen","props","orderId","match","params","id","sdkReady","setSdkReady","orderDetails","state","order","loading","error","userSignin","userInfo","orderPay","loadingPay","errorPay","successPay","success","orderDeliver","loadingDeliver","errorDeliver","successDeliver","dispatch","addPayPalScript","get","data","script","document","createElement","type","src","async","onload","body","appendChild","_id","isPaid","window","paypal","successPaymentHandler","paymentResult","deliverHandler","deliverOrder","shippingAddress","fullName","address","city","postalCode","country","isDelivered","deliveredAt","paymentMethod","paidAt","orderItems","map","item","product","image","name","qty","price","itemsPrice","toFixed","shippingPrice","taxPrice","totalPrice","isAdmin"],"mappings":"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","sourcesContent":["import Axios from \"axios\";\r\nimport { PayPalButton } from \"react-paypal-button-v2\";\r\nimport React from \"react\";\r\nimport { useState } from \"react\";\r\nimport { useEffect } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { detailsOrder, payOrder } from \"../../../Actions/orderActions.js\";\r\nimport LoadingBox from \"../../LoadingBox.js\";\r\nimport MessageBox from \"../../MessageBox.js\";\r\nimport \"../PlaceOrderScreen/PlaceOrderScreen.css\";\r\nimport { ORDER_DELIVER_RESET, ORDER_PAY_RESET } from \"../../../Constants/orderConstants.js\";\r\n\r\n\r\nexport default function OrderScreen(props) { const orderId = props.match.params.id;\r\nconst [sdkReady, setSdkReady] = useState(false);\r\nconst orderDetails = useSelector((state) => state.orderDetails);\r\nconst { order, loading, error } = orderDetails;\r\nconst userSignin = useSelector((state) => state.userSignin);\r\nconst { userInfo } = userSignin;\r\n  const orderPay = useSelector((state) => state.orderPay);\r\n  const {\r\n    loading: loadingPay,\r\n    error: errorPay,\r\n    success: successPay,\r\n  } = orderPay;\r\n   const orderDeliver = useSelector((state) => state.orderDeliver);\r\n   const {\r\n     loading: loadingDeliver,\r\n     error: errorDeliver,\r\n     success: successDeliver,\r\n   } = orderDeliver;\r\nconst dispatch = useDispatch();\r\nuseEffect(() => {\r\n  const addPayPalScript = async () => {\r\n    const { data } = await Axios.get(\"/config/paypal\");\r\n    const script = document.createElement(\"script\");\r\n    script.type = \"text/javascript\";\r\n    script.src = `https://www.paypal.com/sdk/js?client-id=${data}`;\r\n    script.async = true;\r\n    script.onload = () => {\r\n      setSdkReady(true);\r\n    };\r\n    document.body.appendChild(script);\r\n  };\r\n  if (\r\n    !order ||\r\n    successPay ||\r\n    successDeliver ||\r\n    (order && order._id !== orderId)\r\n  ) {\r\n    dispatch({ type: ORDER_PAY_RESET });\r\n    dispatch({ type: ORDER_DELIVER_RESET });\r\n    dispatch(detailsOrder(orderId));\r\n  } else {\r\n    if (!order.isPaid) {\r\n      if (!window.paypal) {\r\n        addPayPalScript();\r\n      } else {\r\n        setSdkReady(true);\r\n      }\r\n    }\r\n  }\r\n}, [dispatch, order, orderId, sdkReady, successPay, successDeliver]);\r\n\r\nconst successPaymentHandler = (paymentResult) => {\r\n  dispatch(payOrder(order, paymentResult));\r\n};\r\n\r\n const deliverHandler = () => {\r\n   dispatch(deliverOrder(order._id));\r\n };\r\n\r\n  return loading ? (\r\n    <LoadingBox></LoadingBox>\r\n  ) : error ? (\r\n    <MessageBox variant=\"danger\">{error}</MessageBox>\r\n  ) : (\r\n    <div>\r\n      <h1>Order {order._id}</h1>\r\n      <div className=\"row top\">\r\n        <div className=\"col\">\r\n          <ul>\r\n            <li>\r\n              <div className=\"Shipping\">\r\n                <h2 className=\"Heads\">Shipping</h2>\r\n                <p>\r\n                  <strong>Name:</strong> {order.shippingAddress.fullName} <br />\r\n                  <strong>Address: </strong> {order.shippingAddress.address},\r\n                  {order.shippingAddress.city},{\" \"}\r\n                  {order.shippingAddress.postalCode},\r\n                  {order.shippingAddress.country}\r\n                </p>\r\n                {order.isDelivered ? (\r\n                  <MessageBox variant=\"success\">\r\n                    Delivered at {order.deliveredAt}\r\n                  </MessageBox>\r\n                ) : (\r\n                  <MessageBox variant=\"danger\">Not Delivered</MessageBox>\r\n                )}\r\n              </div>\r\n            </li>\r\n            <li>\r\n              <div className=\"Payment_method\">\r\n                <h2 className=\"Heads\">Payment</h2>\r\n                <p>\r\n                  <strong>Method:</strong> {order.paymentMethod}\r\n                </p>\r\n                {order.isPaid ? (\r\n                  <MessageBox variant=\"success\">\r\n                    Paid at {order.paidAt}\r\n                  </MessageBox>\r\n                ) : (\r\n                  <MessageBox variant=\"danger\">Not Paid</MessageBox>\r\n                )}\r\n              </div>\r\n            </li>\r\n            <li>\r\n              <div className=\"card card-body\">\r\n                <h2>Order Items</h2>\r\n                <ul>\r\n                  {order.orderItems.map((item) => (\r\n                    <li key={item.product}>\r\n                      <div className=\"row\">\r\n                        <div>\r\n                          <img\r\n                            src={item.image}\r\n                            alt={item.name}\r\n                            className=\"small\"\r\n                          ></img>\r\n                        </div>\r\n                        <div className=\"item\">\r\n                          <Link to={`/product/${item.product}`}>\r\n                            {item.name}\r\n                          </Link>\r\n                        </div>\r\n                        <div className=\"item\">\r\n                          {item.qty} x ₹{item.price} = ₹{item.qty * item.price}\r\n                        </div>\r\n                      </div>\r\n                    </li>\r\n                  ))}\r\n                </ul>\r\n              </div>\r\n            </li>\r\n          </ul>\r\n        </div>\r\n        <div className=\"col\">\r\n          <div className=\"Summary_main\">\r\n            <ul>\r\n              <li>\r\n                <h2 className=\"order_summary\">Order Summary</h2>\r\n              </li>\r\n              <li>\r\n                <div className=\"row\">\r\n                  <div className=\"Summary\">Items' Price</div>\r\n                  <div>₹{order.itemsPrice.toFixed(2)}</div>\r\n                </div>\r\n              </li>\r\n              <li>\r\n                <div className=\"row\">\r\n                  <div className=\"Summary\"> Shipping</div>\r\n                  <div>₹{order.shippingPrice.toFixed(2)}</div>\r\n                </div>\r\n              </li>\r\n              <li>\r\n                <div className=\"row\">\r\n                  <div className=\"Summary\">Tax</div>\r\n                  <div>₹{order.taxPrice.toFixed(2)}</div>\r\n                </div>\r\n              </li>\r\n              <li>\r\n                <div className=\"row\">\r\n                  <div>\r\n                    <strong className=\"Summary\"> Order Total</strong>\r\n                  </div>\r\n                  <div>\r\n                    <strong>₹{order.totalPrice.toFixed(2)}</strong>\r\n                  </div>\r\n                </div>\r\n              </li>\r\n              {!order.isPaid && (\r\n                <li>\r\n                  {!sdkReady ? (\r\n                    <LoadingBox></LoadingBox>\r\n                  ) : (\r\n                    <>\r\n                      {errorPay && (\r\n                        <MessageBox variant=\"danger\">{errorPay}</MessageBox>\r\n                      )}\r\n                      {loadingPay && <LoadingBox></LoadingBox>}\r\n\r\n                      <PayPalButton\r\n                        amount={order.totalPrice}\r\n                        onSuccess={successPaymentHandler}\r\n                      ></PayPalButton>\r\n                    </>\r\n                  )}\r\n                </li>\r\n              )}\r\n              {userInfo.isAdmin && order.isPaid && !order.isDelivered && (\r\n                <li>\r\n                  {loadingDeliver && <LoadingBox></LoadingBox>}\r\n                  {errorDeliver && (\r\n                    <MessageBox variant=\"danger\">{errorDeliver}</MessageBox>\r\n                  )}\r\n                  <button\r\n                    type=\"button\"\r\n                    className=\"primary block\"\r\n                    onClick={deliverHandler}\r\n                  >\r\n                    Deliver Order\r\n                  </button>\r\n                </li>\r\n              )}\r\n            </ul>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}